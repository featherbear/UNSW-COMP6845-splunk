(function(){const l=document.createElement("link").relList;if(l&&l.supports&&l.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const u of r)if(u.type==="childList")for(const p of u.addedNodes)p.tagName==="LINK"&&p.rel==="modulepreload"&&n(p)}).observe(document,{childList:!0,subtree:!0});function o(r){const u={};return r.integrity&&(u.integrity=r.integrity),r.referrerPolicy&&(u.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?u.credentials="include":r.crossOrigin==="anonymous"?u.credentials="omit":u.credentials="same-origin",u}function n(r){if(r.ep)return;r.ep=!0;const u=o(r);fetch(r.href,u)}})();function N(){}function ut(s,l){for(const o in l)s[o]=l[o];return s}function lt(s){return s()}function Xe(){return Object.create(null)}function $e(s){s.forEach(lt)}function st(s){return typeof s=="function"}function se(s,l){return s!=s?l==l:s!==l||s&&typeof s=="object"||typeof s=="function"}let Ae;function Ze(s,l){return Ae||(Ae=document.createElement("a")),Ae.href=l,s===Ae.href}function rt(s){return Object.keys(s).length===0}function pt(s,l,o,n){if(s){const r=ot(s,l,o,n);return s[0](r)}}function ot(s,l,o,n){return s[1]&&n?ut(o.ctx.slice(),s[1](n(l))):o.ctx}function ct(s,l,o,n){if(s[2]&&n){const r=s[2](n(o));if(l.dirty===void 0)return r;if(typeof r=="object"){const u=[],p=Math.max(l.dirty.length,r.length);for(let a=0;a<p;a+=1)u[a]=l.dirty[a]|r[a];return u}return l.dirty|r}return l.dirty}function dt(s,l,o,n,r,u){if(r){const p=ot(l,o,n,u);s.p(p,r)}}function mt(s){if(s.ctx.length>32){const l=[],o=s.ctx.length/32;for(let n=0;n<o;n++)l[n]=-1;return l}return-1}const at=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global;function U(s,l){s.appendChild(l)}function t(s,l,o){s.insertBefore(l,o||null)}function e(s){s.parentNode&&s.parentNode.removeChild(s)}function wt(s,l){for(let o=0;o<s.length;o+=1)s[o]&&s[o].d(l)}function i(s){return document.createElement(s)}function te(s){return document.createTextNode(s)}function f(){return te(" ")}function ze(){return te("")}function Ue(s,l,o,n){return s.addEventListener(l,o,n),()=>s.removeEventListener(l,o,n)}function X(s,l,o){o==null?s.removeAttribute(l):s.getAttribute(l)!==o&&s.setAttribute(l,o)}function bt(s){return Array.from(s.childNodes)}function Ge(s,l){l=""+l,s.data!==l&&(s.data=l)}function Se(s,l,o,n){o==null?s.style.removeProperty(l):s.style.setProperty(l,o,n?"important":"")}function Pe(s,l,o){s.classList[o?"add":"remove"](l)}function We(s,l){return new s(l)}let qe;function Ce(s){qe=s}function _t(){if(!qe)throw new Error("Function called outside component initialization");return qe}function it(s){_t().$$.on_mount.push(s)}const Le=[],Te=[];let Me=[];const Ne=[],kt=Promise.resolve();let Fe=!1;function yt(){Fe||(Fe=!0,kt.then(nt))}function Re(s){Me.push(s)}function vt(s){Ne.push(s)}const Oe=new Set;let he=0;function nt(){if(he!==0)return;const s=qe;do{try{for(;he<Le.length;){const l=Le[he];he++,Ce(l),xt(l.$$)}}catch(l){throw Le.length=0,he=0,l}for(Ce(null),Le.length=0,he=0;Te.length;)Te.pop()();for(let l=0;l<Me.length;l+=1){const o=Me[l];Oe.has(o)||(Oe.add(o),o())}Me.length=0}while(Le.length);for(;Ne.length;)Ne.pop()();Fe=!1,Oe.clear(),Ce(s)}function xt(s){if(s.fragment!==null){s.update(),$e(s.before_update);const l=s.dirty;s.dirty=[-1],s.fragment&&s.fragment.p(s.ctx,l),s.after_update.forEach(Re)}}function Tt(s){const l=[],o=[];Me.forEach(n=>s.indexOf(n)===-1?l.push(n):o.push(n)),o.forEach(n=>n()),Me=l}const Ie=new Set;let xe;function Ee(){xe={r:0,c:[],p:xe}}function De(){xe.r||$e(xe.c),xe=xe.p}function J(s,l){s&&s.i&&(Ie.delete(s),s.i(l))}function g(s,l,o,n){if(s&&s.o){if(Ie.has(s))return;Ie.add(s),xe.c.push(()=>{Ie.delete(s),n&&(o&&s.d(1),n())}),s.o(l)}else n&&n()}function ht(s,l,o){const n=s.$$.props[l];n!==void 0&&(s.$$.bound[n]=o,o(s.$$.ctx[n]))}function me(s){s&&s.c()}function pe(s,l,o,n){const{fragment:r,after_update:u}=s.$$;r&&r.m(l,o),n||Re(()=>{const p=s.$$.on_mount.map(lt).filter(st);s.$$.on_destroy?s.$$.on_destroy.push(...p):$e(p),s.$$.on_mount=[]}),u.forEach(Re)}function ce(s,l){const o=s.$$;o.fragment!==null&&(Tt(o.after_update),$e(o.on_destroy),o.fragment&&o.fragment.d(l),o.on_destroy=o.fragment=null,o.ctx=[])}function Lt(s,l){s.$$.dirty[0]===-1&&(Le.push(s),yt(),s.$$.dirty.fill(0)),s.$$.dirty[l/31|0]|=1<<l%31}function oe(s,l,o,n,r,u,p,a=[-1]){const w=qe;Ce(s);const k=s.$$={fragment:null,ctx:[],props:u,update:N,not_equal:r,bound:Xe(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(l.context||(w?w.$$.context:[])),callbacks:Xe(),dirty:a,skip_bound:!1,root:l.target||w.$$.root};p&&p(k.root);let b=!1;if(k.ctx=o?o(s,l.props||{},(_,S,...y)=>{const h=y.length?y[0]:S;return k.ctx&&r(k.ctx[_],k.ctx[_]=h)&&(!k.skip_bound&&k.bound[_]&&k.bound[_](h),b&&Lt(s,_)),S}):[],k.update(),b=!0,$e(k.before_update),k.fragment=n?n(k.ctx):!1,l.target){if(l.hydrate){const _=bt(l.target);k.fragment&&k.fragment.l(_),_.forEach(e)}else k.fragment&&k.fragment.c();l.intro&&J(s.$$.fragment),pe(s,l.target,l.anchor,l.customElement),nt()}Ce(w)}class ie{$destroy(){ce(this,1),this.$destroy=N}$on(l,o){if(!st(o))return N;const n=this.$$.callbacks[l]||(this.$$.callbacks[l]=[]);return n.push(o),()=>{const r=n.indexOf(o);r!==-1&&n.splice(r,1)}}$set(l){this.$$set&&!rt(l)&&(this.$$.skip_bound=!0,this.$$set(l),this.$$.skip_bound=!1)}}function St(s){let l;return{c(){l=i("div"),X(l,"class","svelte-1h5ldsd"),Pe(l,"hover",!s[0])},m(o,n){t(o,l,n),s[5](l)},p(o,[n]){n&1&&Pe(l,"hover",!o[0])},i:N,o:N,d(o){o&&e(l),s[5](null)}}}function Mt(s){const l=s.getBoundingClientRect(),o=window.innerHeight||document.documentElement.clientHeight;return l.top*1.05<=o&&l.left>=0&&l.right<=(window.innerWidth||document.documentElement.clientWidth)}function Ht(s,l,o){let{path:n}=l,{options:r={}}=l,{fixed:u=!1}=l,{loopDelay:p=2e3}=l,a={preload:!0,poster:"npt:10:10",autoPlay:!0},w;it(()=>{let b={...a,...r},_=!1;b.autoPlay&&(b.autoPlay=!1,_=!0);let S=window.AsciinemaPlayer.create("asciinema/recordings/"+n,w,b);const y=function(){w&&Mt(w)&&_&&(console.debug("Scroll event triggered for "+n),document.removeEventListener("scroll",y),_=!1,S.play())};setTimeout(()=>(p&&(console.debug("Attaching end-listener for "+n),S.addEventListener("ended",()=>{setTimeout(()=>S.getCurrentTime()==S.getDuration()&&S.play(),p)})),_&&(console.debug("Attaching scroll-listener for "+n),document.addEventListener("scroll",y,{passive:!0}),y()),()=>{document.removeEventListener("scroll",y),S.dispose()}),0)});function k(b){Te[b?"unshift":"push"](()=>{w=b,o(1,w)})}return s.$$set=b=>{"path"in b&&o(2,n=b.path),"options"in b&&o(3,r=b.options),"fixed"in b&&o(0,u=b.fixed),"loopDelay"in b&&o(4,p=b.loopDelay)},[u,w,n,r,p,k]}class Ve extends ie{constructor(l){super(),oe(this,l,Ht,St,se,{path:2,options:3,fixed:0,loopDelay:4})}}function Ct(s){let l,o,n,r,u,p,a,w,k,b,_,S,y,h,m,C,B,q,A,$,W,F,R,V,H,O,K,G,z,j,Q,Y,d,M,ee,Z;return m=new Ve({props:{path:"docker_pull.cast",options:{speed:20,rows:16}}}),K=new Ve({props:{path:"docker_run.cast",options:{cols:150,speed:5}}}),{c(){l=i("h2"),l.textContent="Getting Started",o=f(),n=i("blockquote"),n.innerHTML=`<p>If you run into Docker issues during the setup of Splunk, see the <a href="#12">troubleshooting page</a>.<br/>
If that doesn’t help, go bug your classmates or course staff…</p>`,r=f(),u=i("h3"),u.textContent="Downloading Docker",p=f(),a=i("p"),a.innerHTML=`First we will need to install <a href="https://www.docker.com/" rel="nofollow">Docker</a>.<br/>
You can download this from the <a href="https://www.docker.com/" rel="nofollow">official website</a>, or your preferred choice of package manager.`,w=f(),k=i("p"),k.innerHTML='<em>You may use an alternative like <a href="https://podman.io/" rel="nofollow">Podman</a> or <a href="https://github.com/abiosoft/colima" rel="nofollow">Colima</a> but we cannot guarantee their compatibility for this lab.</em>',b=f(),_=i("h3"),_.textContent="Downloading Splunk (Docker image)",S=f(),y=i("blockquote"),y.innerHTML="<p>$&gt; <code>docker pull splunk/splunk</code></p>",h=f(),me(m.$$.fragment),C=f(),B=i("h3"),B.textContent="Running Splunk via Docker",q=f(),A=i("p"),A.innerHTML="The below command will start Splunk in a Docker container, which you can access via <code>http://localhost:8000</code>",$=f(),W=i("blockquote"),W.innerHTML="<p>$&gt; <code>docker run -it -e SPLUNK_START_ARGS=--accept-license -e SPLUNK_PASSWORD=helloworld -p 8000:8000 -p 8089:8089 splunk/splunk start</code></p>",F=f(),R=i("ul"),R.innerHTML=`<li><code>run</code> - Docker run command</li> 
<li><code>-it</code> - Run interactive with a terminal (allows you to interact with the container via the terminal)</li> 
<li><code>-e SPLUNK_START_ARGS=--accept-license</code> - Set the environment variable <code>SPLUNK_START_ARGS</code></li> 
<li><code>-e SPLUNK_PASSWORD=helloworld</code> - Set the environment variable <code>SPLUNK_PASSWORD</code><ul><li>You may change this to a password of your choice, as long as it conforms to the <a href="https://docs.splunk.com/Documentation/Splunk/latest/Security/Configurepasswordsinspecfile" rel="nofollow">Splunk Enterprise password policy</a></li> 
<li>(Default: Minimum of 8 characters)</li></ul></li> 
<li><code>-p 8000:8000</code> - Bind your machine’s port <code>8000</code> to the container’s port <code>8000</code></li> 
<li><code>-p 8089:8089</code> - Bind your machine’s port <code>8089</code> to the container’s port <code>8089</code></li> 
<li><code>splunk/splunk</code> - The docker image name for Splunk</li> 
<li><code>start</code> - Arguments to pass to the Splunk image</li>`,V=f(),H=i("p"),H.innerHTML="Splunk has finished starting when you can see the output <code>Ansible playbook complete, will begin streaming splunkd_stderr.log</code>",O=f(),me(K.$$.fragment),G=f(),z=i("hr"),j=f(),Q=i("p"),Q.innerHTML="Leave the terminal window open in the background, and navigate to <code>http://localhost:8000</code> in your preferred web browser.",Y=f(),d=i("p"),d.innerHTML="You can log in with username <code>admin</code> and password <code>helloworld</code> (or whatever you set)",M=f(),ee=i("p"),ee.innerHTML='<img src="images/splunk_login.png"/>'},m(T,D){t(T,l,D),t(T,o,D),t(T,n,D),t(T,r,D),t(T,u,D),t(T,p,D),t(T,a,D),t(T,w,D),t(T,k,D),t(T,b,D),t(T,_,D),t(T,S,D),t(T,y,D),t(T,h,D),pe(m,T,D),t(T,C,D),t(T,B,D),t(T,q,D),t(T,A,D),t(T,$,D),t(T,W,D),t(T,F,D),t(T,R,D),t(T,V,D),t(T,H,D),t(T,O,D),pe(K,T,D),t(T,G,D),t(T,z,D),t(T,j,D),t(T,Q,D),t(T,Y,D),t(T,d,D),t(T,M,D),t(T,ee,D),Z=!0},p:N,i(T){Z||(J(m.$$.fragment,T),J(K.$$.fragment,T),Z=!0)},o(T){g(m.$$.fragment,T),g(K.$$.fragment,T),Z=!1},d(T){T&&e(l),T&&e(o),T&&e(n),T&&e(r),T&&e(u),T&&e(p),T&&e(a),T&&e(w),T&&e(k),T&&e(b),T&&e(_),T&&e(S),T&&e(y),T&&e(h),ce(m,T),T&&e(C),T&&e(B),T&&e(q),T&&e(A),T&&e($),T&&e(W),T&&e(F),T&&e(R),T&&e(V),T&&e(H),T&&e(O),ce(K,T),T&&e(G),T&&e(z),T&&e(j),T&&e(Q),T&&e(Y),T&&e(d),T&&e(M),T&&e(ee)}}}class Be extends ie{constructor(l){super(),oe(this,l,null,Ct,se,{})}}function qt(s){let l,o,n,r,u,p,a,w,k;return{c(){l=i("h2"),l.textContent="License Note",o=f(),n=i("p"),n.innerHTML=`Upon the initial setup of Splunk, you are given a 60-day Splunk Enterprise Trial license, which gives access to all features of Splunk Enterprise.<br/>
The Splunk Enterprise Trial license however <u>only allows you to index 500 MB of data per day</u>.`,r=f(),u=i("p"),u.innerHTML='A Free license also exists (no time limit) however with less features to Splunk Enterprise. Read more about the <a href="https://docs.splunk.com/Documentation/Splunk/9.0.5/Admin/TypesofSplunklicenses#Other_types_of_licenses" rel="nofollow">license information and restrictions here</a>.',p=f(),a=i("p"),a.textContent="When running Splunk on Docker, all data (including the instance license) is bound to the Docker container (unless a volume / bind mount was made).",w=f(),k=i("p"),k.textContent="If the trial period elapses, one can simply recreate the Docker container and start again (logs will need to be ingested again)"},m(b,_){t(b,l,_),t(b,o,_),t(b,n,_),t(b,r,_),t(b,u,_),t(b,p,_),t(b,a,_),t(b,w,_),t(b,k,_)},p:N,i:N,o:N,d(b){b&&e(l),b&&e(o),b&&e(n),b&&e(r),b&&e(u),b&&e(p),b&&e(a),b&&e(w),b&&e(k)}}}class $t extends ie{constructor(l){super(),oe(this,l,null,qt,se,{})}}function At(s){let l,o,n,r,u,p,a,w,k,b,_,S,y,h,m,C,B,q,A,$,W,F,R,V=`<code class="language-undefined">= Context =
Web sever logs contain information on any event that was registered/logged.
This contains a lot of insights on website visitors, behavior, crawlers accessing the site, business insights, security issues, and more.
This is a dataset for trying to gain insights from such a file. 

= Content =
3.3GB of logs from an Iranian ecommerce website zanbil.ir.

= Acknowledgements =
Zaker, Farzin, 2019, &quot;Online Shopping Store - Web Server Logs&quot;, https://doi.org/10.7910/DVN/3QBYB5, Harvard Dataverse, V1

https://www.kaggle.com/datasets/eliasdabbas/web-server-access-logs
https://dataverse.harvard.edu/dataset.xhtml?persistentId=doi:10.7910/DVN/3QBYB5
</code>`;return{c(){l=i("h2"),l.textContent="About Log Contexts",o=f(),n=i("p"),n.innerHTML=`Generally speaking, Splunk is used as a SIEM to aggregate logs - however nothing is stopping us from ingesting a <em>log2timeline</em>-style export.<br/>
Before we do anything to do with logs, we want to ensure that the context of the story / timeline we are exploring is correct.`,r=f(),u=i("p"),u.innerHTML=`Logs can come from all sorts of places, and <strong>timezones!</strong> As such, the the timezones could be in a range of formats from UTC, GMT, EPOCH etc.<br/>
As a Splunk engineer, we need to ensure that we aware of the timezone for the logs, as well as our own system.`,p=f(),a=i("p"),a.innerHTML=`To identify the timezone from a log file, we should look into the contents of the log file.
If we can see a timestamp in the log file with an absolute timezone offset (e.g. +0000, or +1000) - We can be sure of the timestamp’s relative (and absolute) time.<br/>
However, if a timestamp in the log file is ambiguous, we may need to seek more context surrounding the file (where did we obtain the log file from?)`,w=f(),k=i("hr"),b=f(),_=i("blockquote"),_.innerHTML="<p>Question: What is the benefit of having a log file which logs to +0000 ?</p>",S=f(),y=i("hr"),h=f(),m=i("h3"),m.textContent="Lab Resource Download",C=f(),B=i("p"),B.textContent="For the first part of this lab, we will be using a sample web server access log file licensed in the public domain.",q=f(),A=i("p"),A.innerHTML=`Download the <code>6845 - Web Server Access Logs.zip</code> file from <a href="https://www.openlearning.com/unswcourses/courses/digital-forensics/downloads" rel="nofollow">OpenLearning</a>.<br/>
Confirm that the MD5 hashsum of the extracted <code>access.log</code> file matches <code>528bcc8e31b4c376ab66479e7a370e6b</code>`,$=f(),W=i("hr"),F=f(),R=i("pre"),X(R,"class","language-undefined")},m(H,O){t(H,l,O),t(H,o,O),t(H,n,O),t(H,r,O),t(H,u,O),t(H,p,O),t(H,a,O),t(H,w,O),t(H,k,O),t(H,b,O),t(H,_,O),t(H,S,O),t(H,y,O),t(H,h,O),t(H,m,O),t(H,C,O),t(H,B,O),t(H,q,O),t(H,A,O),t(H,$,O),t(H,W,O),t(H,F,O),t(H,R,O),R.innerHTML=V},p:N,i:N,o:N,d(H){H&&e(l),H&&e(o),H&&e(n),H&&e(r),H&&e(u),H&&e(p),H&&e(a),H&&e(w),H&&e(k),H&&e(b),H&&e(_),H&&e(S),H&&e(y),H&&e(h),H&&e(m),H&&e(C),H&&e(B),H&&e(q),H&&e(A),H&&e($),H&&e(W),H&&e(F),H&&e(R)}}}class It extends ie{constructor(l){super(),oe(this,l,null,At,se,{})}}function Pt(s){let l,o;return{c(){l=i("iframe"),Ze(l.src,o="https://www.youtube.com/embed/"+s[0])||X(l,"src",o),Se(l,"aspect-ratio",s[2]),X(l,"title",s[1]),X(l,"frameborder","0"),X(l,"allow","accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"),l.allowFullscreen=!0,X(l,"class","svelte-1dkv1z2")},m(n,r){t(n,l,r)},p(n,[r]){r&1&&!Ze(l.src,o="https://www.youtube.com/embed/"+n[0])&&X(l,"src",o),r&4&&Se(l,"aspect-ratio",n[2]),r&2&&X(l,"title",n[1])},i:N,o:N,d(n){n&&e(l)}}}function Wt(s,l,o){let{id:n}=l,{title:r="YouTube Video"}=l,{aspectRatio:u="16/9"}=l;return s.$$set=p=>{"id"in p&&o(0,n=p.id),"title"in p&&o(1,r=p.title),"aspectRatio"in p&&o(2,u=p.aspectRatio)},[n,r,u]}class ft extends ie{constructor(l){super(),oe(this,l,Wt,Pt,se,{id:0,title:1,aspectRatio:2})}}function Et(s){let l,o,n,r,u,p,a,w,k,b,_,S,y,h=`<code class="language-undefined">md5::access.log.01.zip = aa10439948c5b770732747e552e375cb
md5::access.log.01     = e2349dc469d6c142c0b158be57aab2a8</code>`;return{c(){l=i("h2"),l.textContent="Log Splitting",o=f(),n=i("p"),n.innerHTML=`As we will be using a Trial license of Splunk Enterprise (log size limit of 500 MB), the <code>access.log</code> file will be too large (3.26 GB) to ingest.<br/>
We will need to split the file.`,r=f(),u=i("blockquote"),u.innerHTML=`<p>Activity: Research and split the <code>access.log</code> file into 450 MB chunks.<br/>
Note - we are using 450MB chunks instead of 500 MB as we have other files to ingest later!</p>`,p=f(),a=i("p"),a.textContent="Once split, we can then proceed to upload any of the 450 MB chunks to Splunk.",w=f(),k=i("hr"),b=f(),_=i("p"),_.innerHTML='The first 450 MB chunk is provided <a href="https://github.com/featherbear/UNSW-COMP6845-splunk/raw/files/access.log.01.zip" rel="nofollow">here</a> for convenience.',S=f(),y=i("pre"),X(y,"class","language-undefined")},m(m,C){t(m,l,C),t(m,o,C),t(m,n,C),t(m,r,C),t(m,u,C),t(m,p,C),t(m,a,C),t(m,w,C),t(m,k,C),t(m,b,C),t(m,_,C),t(m,S,C),t(m,y,C),y.innerHTML=h},p:N,i:N,o:N,d(m){m&&e(l),m&&e(o),m&&e(n),m&&e(r),m&&e(u),m&&e(p),m&&e(a),m&&e(w),m&&e(k),m&&e(b),m&&e(_),m&&e(S),m&&e(y)}}}class Dt extends ie{constructor(l){super(),oe(this,l,null,Et,se,{})}}function Ot(s){let l,o,n,r,u,p,a,w,k,b,_,S,y,h;return y=new ft({props:{id:"hLr7AwkymKY"}}),{c(){l=i("h2"),l.textContent="Log Ingestion",o=f(),n=i("p"),n.innerHTML=`We will now ingest one of the <code>access.log</code> chunks into a new Splunk <em>index</em> called <code>websftp</code>.<br/>
An index can be considered as a ‘collection’ of data with its own purpose (i.e. logical grouping) or requirements (e.g. access privileges, retention periods)`,r=f(),u=i("blockquote"),u.innerHTML="<p>In a real-life situation, the <strong>source type</strong> of an <code>access.log</code> file will likely be the built-in <code>access_combined</code> type. For learning purposes, we will be creating our own source type.</p>",p=f(),a=i("h3"),a.textContent="Text Instructions",w=f(),k=i("ol"),k.innerHTML=`<li>In Splunk, select <strong>Add Data</strong></li> 
<li>Press <strong>Upload files from my computer</strong></li> 
<li>Press <strong>Select File</strong> and choose your log chunk, wait for the data preview generation to finish</li> 
<li>Select the <strong>Source type</strong> to be <code>Default Settings</code></li> 
<li>Adjust the <strong>timezone</strong> to correctly normalise the log event times (if not already automatically determined)</li> 
<li>Save the <strong>Source type</strong> as <code>my_own_log_type</code></li> 
<li>Create an <strong>index</strong> called <code>websftp</code></li> 
<li>Set the <strong>Host field value</strong> to <code>webserver_or_something</code></li> 
<li>Submit the file for uploading and processing</li>`,b=f(),_=i("h3"),_.textContent="Video instructions",S=f(),me(y.$$.fragment)},m(m,C){t(m,l,C),t(m,o,C),t(m,n,C),t(m,r,C),t(m,u,C),t(m,p,C),t(m,a,C),t(m,w,C),t(m,k,C),t(m,b,C),t(m,_,C),t(m,S,C),pe(y,m,C),h=!0},p:N,i(m){h||(J(y.$$.fragment,m),h=!0)},o(m){g(y.$$.fragment,m),h=!1},d(m){m&&e(l),m&&e(o),m&&e(n),m&&e(r),m&&e(u),m&&e(p),m&&e(a),m&&e(w),m&&e(k),m&&e(b),m&&e(_),m&&e(S),ce(y,m)}}}class Bt extends ie{constructor(l){super(),oe(this,l,null,Ot,se,{})}}function Nt(s){let l,o,n,r,u,p,a,w,k,b,_,S,y,h,m,C,B,q,A,$,W,F,R,V,H,O,K,G,z,j,Q,Y,d,M,ee,Z,T,D,le,de,ae,ne,we,fe,ue,re;return le=new ft({props:{id:"1EX7Xh3sL94"}}),{c(){l=i("h2"),l.textContent="Field Extraction",o=f(),n=i("p"),n.innerHTML=`At the moment, if we try to query the logs in Splunk we won’t get very far..<br/>
This is because our custom source type <code>my_own_log_type</code> doesn’t have a mapping of where data should be found within the log entry.`,r=f(),u=i("p"),u.innerHTML='<img src="images/splunk_no_extracted_fields.png"/>',p=f(),a=i("hr"),w=f(),k=i("p"),k.innerHTML='We can create our mapping by selecting <a href="http://localhost:8000/en-US/app/search/field_extractor?sourcetype=my_own_log_type" rel="nofollow"><strong>Extract fields</strong></a>.',b=f(),_=i("blockquote"),_.innerHTML="<p>You can also navigate to <strong>[Settings]</strong> -&gt; <strong>[Fields]</strong> -&gt; <strong>[Field extractions]</strong> -&gt; <strong>[Open Field Extractor]</strong></p>",S=f(),y=i("p"),y.textContent=`Select the “Time Range” drop down and select “All Time” as the date filter to show the log entries.
Select one of the log entries that appears, it will be highlighted and also shown above the page.`,h=f(),m=i("p"),m.innerHTML="We can then try both methods of field extractions, <strong>delimiters</strong> and <strong>regular expressions</strong>.",C=f(),B=i("h3"),B.textContent="Delimiters",q=f(),A=i("p"),A.textContent="Delimiters are characters or sequences of characters that are used to separate or mark the boundaries between different pieces of data within a larger data structure or file. Here are some common examples of standard delimiters:",$=f(),W=i("ul"),W.innerHTML=`<li>Space (<code></code>): A space delimiter is a character that is used to separate data values or tokens within a larger string or file. The most common space delimiter is the space character which is used to separate words in natural language and data values in programming languages.</li> 
<li>Comma (<code>,</code>): Often used to separate values in a list or a data file. For example, in a CSV file (comma-separated values), each data value is separated by a comma.</li> 
<li>Tab (<code>\\t</code>): Used to separate columns in a table or spreadsheet. In a TSV file (tab-separated values), each data value is separated by a tab.</li> 
<li>Pipe (<code>|</code>): Used as a delimiter in many file formats, such as the Linux command output or log files. Each field is separated by a pipe symbol.</li> 
<li>Other: Used when a standard delimiter hasn’t been used to separate the fields. Other can be anything that is a consistent pattern in the log file. For example, the <code>^</code> character, or perhaps <code>-</code>.</li>`,F=f(),R=i("p"),R.textContent="If there is a specific character that separates different fields within an entry, we can try to use the delimiter-based extraction.",V=f(),H=i("blockquote"),H.innerHTML="<p>Try out the different delimiter types for the log entry, does it work well?</p>",O=f(),K=i("p"),K.innerHTML="<em>Delimiter-based extraction doesn’t always work so well because of (e.g.) extraneous <code>]</code> and <code>&quot;</code> characters that may appear</em>",G=f(),z=i("h3"),z.textContent="Regular Expressions",j=f(),Q=i("p"),Q.innerHTML=`In Splunk, regex-based extractions can be done manually (by means of entering a regex string), or graphically (by selecting parts of the entry).<br/>
We can highlight the values we want to extract, then assign it a field name.`,Y=f(),d=i("p"),d.textContent="Let’s create a regex-based extraction with the following fields:",M=f(),ee=i("ul"),ee.innerHTML=`<li><code>src_ip</code></li> 
<li><code>http_method</code></li> 
<li><code>path</code></li> 
<li><code>http_version</code></li> 
<li><code>http_status</code></li> 
<li><code>user_agent</code></li>`,Z=f(),T=i("h3"),T.textContent="Video Instructions",D=f(),me(le.$$.fragment),de=f(),ae=i("hr"),ne=f(),we=i("p"),we.innerHTML=`If we perform a search with the query <a href="http://localhost:8000/en-US/app/search/search?q=search%20index%3Dwebsftp%20sourcetype%3Dmy_own_log_type%20earliest%3D1" rel="nofollow"><code>index=websftp sourcetype=my_own_log_type earliest=1</code></a>, we can see that our fields have been extracted from the logs!<br/> 
<strong>Note: Expand the log entries and toggle the visibilty of the desired fields</strong>`,fe=f(),ue=i("p"),ue.innerHTML='<img src="images/splunk_extracted_fields.png"/>'},m(x,I){t(x,l,I),t(x,o,I),t(x,n,I),t(x,r,I),t(x,u,I),t(x,p,I),t(x,a,I),t(x,w,I),t(x,k,I),t(x,b,I),t(x,_,I),t(x,S,I),t(x,y,I),t(x,h,I),t(x,m,I),t(x,C,I),t(x,B,I),t(x,q,I),t(x,A,I),t(x,$,I),t(x,W,I),t(x,F,I),t(x,R,I),t(x,V,I),t(x,H,I),t(x,O,I),t(x,K,I),t(x,G,I),t(x,z,I),t(x,j,I),t(x,Q,I),t(x,Y,I),t(x,d,I),t(x,M,I),t(x,ee,I),t(x,Z,I),t(x,T,I),t(x,D,I),pe(le,x,I),t(x,de,I),t(x,ae,I),t(x,ne,I),t(x,we,I),t(x,fe,I),t(x,ue,I),re=!0},p:N,i(x){re||(J(le.$$.fragment,x),re=!0)},o(x){g(le.$$.fragment,x),re=!1},d(x){x&&e(l),x&&e(o),x&&e(n),x&&e(r),x&&e(u),x&&e(p),x&&e(a),x&&e(w),x&&e(k),x&&e(b),x&&e(_),x&&e(S),x&&e(y),x&&e(h),x&&e(m),x&&e(C),x&&e(B),x&&e(q),x&&e(A),x&&e($),x&&e(W),x&&e(F),x&&e(R),x&&e(V),x&&e(H),x&&e(O),x&&e(K),x&&e(G),x&&e(z),x&&e(j),x&&e(Q),x&&e(Y),x&&e(d),x&&e(M),x&&e(ee),x&&e(Z),x&&e(T),x&&e(D),ce(le,x),x&&e(de),x&&e(ae),x&&e(ne),x&&e(we),x&&e(fe),x&&e(ue)}}}class Ft extends ie{constructor(l){super(),oe(this,l,null,Nt,se,{})}}function Rt(s){let l,o;const n=s[3].default,r=pt(n,s,s[2],null);return{c(){l=i("span"),r&&r.c(),Se(l,"--fgColour",s[0]),Se(l,"--bgColour",s[1]),X(l,"class","svelte-rwye04")},m(u,p){t(u,l,p),r&&r.m(l,null),o=!0},p(u,[p]){r&&r.p&&(!o||p&4)&&dt(r,n,u,u[2],o?ct(n,u[2],p,null):mt(u[2]),null),(!o||p&1)&&Se(l,"--fgColour",u[0]),(!o||p&2)&&Se(l,"--bgColour",u[1])},i(u){o||(J(r,u),o=!0)},o(u){g(r,u),o=!1},d(u){u&&e(l),r&&r.d(u)}}}function Vt(s,l,o){let{$$slots:n={},$$scope:r}=l,{colour:u="white"}=l,{background:p}=l;return s.$$set=a=>{"colour"in a&&o(0,u=a.colour),"background"in a&&o(1,p=a.background),"$$scope"in a&&o(2,r=a.$$scope)},[u,p,r,n]}class He extends ie{constructor(l){super(),oe(this,l,Vt,Rt,se,{colour:0,background:1})}}function zt(s){let l;return{c(){l=te("Orange")},m(o,n){t(o,l,n)},d(o){o&&e(l)}}}function Ut(s){let l;return{c(){l=te("Green")},m(o,n){t(o,l,n)},d(o){o&&e(l)}}}function Gt(s){let l;return{c(){l=te("Blue")},m(o,n){t(o,l,n)},d(o){o&&e(l)}}}function Yt(s){let l;return{c(){l=te("Purple")},m(o,n){t(o,l,n)},d(o){o&&e(l)}}}function Kt(s){let l;return{c(){l=te("Red")},m(o,n){t(o,l,n)},d(o){o&&e(l)}}}function jt(s){let l,o,n,r,u,p,a,w,k,b,_,S,y,h,m,C,B,q,A,$,W,F,R,V,H,O,K,G,z,j,Q,Y,d,M,ee,Z,T,D,le,de,ae,ne,we,fe,ue,re,x,I,ke,_e,ye,be,v,P,ve;return W=new He({props:{background:"#ff7718",$$slots:{default:[zt]},$$scope:{ctx:s}}}),H=new He({props:{background:"#14ac40",$$slots:{default:[Ut]},$$scope:{ctx:s}}}),z=new He({props:{background:"#009ae6",$$slots:{default:[Gt]},$$scope:{ctx:s}}}),d=new He({props:{background:"#9f40a0",$$slots:{default:[Yt]},$$scope:{ctx:s}}}),T=new He({props:{background:"#eb1a22",$$slots:{default:[Kt]},$$scope:{ctx:s}}}),{c(){l=i("h2"),l.textContent="Introduction to Searching",o=f(),n=i("p"),n.innerHTML=`<em>So Splunk is like a giant database, right?</em><br/> 
<em>So therefore, to get information back, we need to make queries to the database, right?</em><br/> 
<em>So if we need to make queries, there should be some sort of query language, right?</em><br/> 
<em>Maybe something like SQL, right?</em>`,r=f(),u=i("p"),u.innerHTML=`Splunk uses its own query language called <strong>Search Processing Language</strong> (<strong>SPL</strong>) (<a href="https://www.splunk.com/pdfs/solution-guides/splunk-quick-reference-guide.pdf" rel="nofollow">more info here</a>).<br/>
Apart from the basic search constructs of a query langage, SPL also supports chaining queries (i.e. piping), visualisation commands (i.e. graphing), and data massaging commands (i.e. renaming fields)`,p=f(),a=i("p"),a.textContent="(For the future you, Splunk supports basic string searching on the entire log entry without needing to specify a field)",w=f(),k=i("blockquote"),k.innerHTML=`<p>This lab covers some of the basic SPL queries / keywords / syntax, but is not an extensive guide.<br/>
When in doubt, consult <a href="https://featherbear.cc" rel="nofollow">@featherbear</a>, or better yet - Google.</p>`,b=f(),_=i("hr"),S=f(),y=i("h3"),y.textContent="The Search Interface",h=f(),m=i("blockquote"),m.innerHTML='<p>Available here - <a href="http://localhost:8000/en-US/app/search/search" rel="nofollow">http://localhost:8000/en-US/app/search/search</a></p>',C=f(),B=i("p"),B.innerHTML='<img src="images/splunk_search_interface.png"/>',q=f(),A=i("ul"),$=i("li"),me(W.$$.fragment),F=te(" - Splunk query input field -  Enter the SPL query to run here"),R=f(),V=i("li"),me(H.$$.fragment),O=te(" - Data tab - Different output formats of the query result"),K=f(),G=i("li"),me(z.$$.fragment),j=te(" - Field discovery - Information and statistics about specific fields"),Q=f(),Y=i("li"),me(d.$$.fragment),M=te(" - Time range selection - Selects the time range for which logs should be included. Value can be set in the SPL query."),ee=f(),Z=i("li"),me(T.$$.fragment),D=te(" - The "),le=i("a"),le.textContent="search mode",de=te(' that should be used. Use "Fast" at the expense of verbosity and debuggability.'),ae=f(),ne=i("hr"),we=f(),fe=i("h3"),fe.textContent="Which Index?",ue=f(),re=i("p"),re.textContent="In large organisations there may be hundreds of indexes… How do we know what indexes are available, or which to use?",x=f(),I=i("p"),I.textContent="Generally, an index covers a specific purpose, such as: firewall events, load balancer alerts, office audit logs, Windows Event Log, etc…",ke=f(),_e=i("p"),_e.innerHTML="Try run the SPL below, it will return a table of the known <code>index</code> values (i.e. all the indexes)",ye=f(),be=i("blockquote"),be.innerHTML="<p>splunk&gt; <code>index=* earliest=1 | table index | dedup index</code></p>",v=f(),P=i("ul"),P.innerHTML=`<li><code>index=*</code> - Select all indexes</li> 
<li><code>earliest=1</code> - Find entries with epoch time &gt;=1 (basically everything)</li> 
<li><code>|</code> - Pipe results to the next query<ul><li><code>table index</code> - Visualise a table containing the columns: <code>index</code></li></ul></li> 
<li><code>|</code> - Pipe results to the next query<ul><li><code>dedup index</code> - Deduplicate entries with the same column values in <code>index</code></li></ul></li>`,X(le,"href","https://docs.splunk.com/Documentation/SplunkCloud/latest/Search/Changethesearchmode")},m(L,c){t(L,l,c),t(L,o,c),t(L,n,c),t(L,r,c),t(L,u,c),t(L,p,c),t(L,a,c),t(L,w,c),t(L,k,c),t(L,b,c),t(L,_,c),t(L,S,c),t(L,y,c),t(L,h,c),t(L,m,c),t(L,C,c),t(L,B,c),t(L,q,c),t(L,A,c),U(A,$),pe(W,$,null),U($,F),U(A,R),U(A,V),pe(H,V,null),U(V,O),U(A,K),U(A,G),pe(z,G,null),U(G,j),U(A,Q),U(A,Y),pe(d,Y,null),U(Y,M),U(A,ee),U(A,Z),pe(T,Z,null),U(Z,D),U(Z,le),U(Z,de),t(L,ae,c),t(L,ne,c),t(L,we,c),t(L,fe,c),t(L,ue,c),t(L,re,c),t(L,x,c),t(L,I,c),t(L,ke,c),t(L,_e,c),t(L,ye,c),t(L,be,c),t(L,v,c),t(L,P,c),ve=!0},p(L,[c]){const E={};c&1&&(E.$$scope={dirty:c,ctx:L}),W.$set(E);const Ye={};c&1&&(Ye.$$scope={dirty:c,ctx:L}),H.$set(Ye);const Ke={};c&1&&(Ke.$$scope={dirty:c,ctx:L}),z.$set(Ke);const je={};c&1&&(je.$$scope={dirty:c,ctx:L}),d.$set(je);const Qe={};c&1&&(Qe.$$scope={dirty:c,ctx:L}),T.$set(Qe)},i(L){ve||(J(W.$$.fragment,L),J(H.$$.fragment,L),J(z.$$.fragment,L),J(d.$$.fragment,L),J(T.$$.fragment,L),ve=!0)},o(L){g(W.$$.fragment,L),g(H.$$.fragment,L),g(z.$$.fragment,L),g(d.$$.fragment,L),g(T.$$.fragment,L),ve=!1},d(L){L&&e(l),L&&e(o),L&&e(n),L&&e(r),L&&e(u),L&&e(p),L&&e(a),L&&e(w),L&&e(k),L&&e(b),L&&e(_),L&&e(S),L&&e(y),L&&e(h),L&&e(m),L&&e(C),L&&e(B),L&&e(q),L&&e(A),ce(W),ce(H),ce(z),ce(d),ce(T),L&&e(ae),L&&e(ne),L&&e(we),L&&e(fe),L&&e(ue),L&&e(re),L&&e(x),L&&e(I),L&&e(ke),L&&e(_e),L&&e(ye),L&&e(be),L&&e(v),L&&e(P)}}}class Qt extends ie{constructor(l){super(),oe(this,l,null,jt,se,{})}}function Xt(s){let l,o,n,r,u,p,a,w=`<code class="language-undefined">index: websftp
sourcetype: my_own_log_type
host: webserver_or_something</code>`,k,b,_,S,y,h,m,C,B,q,A,$,W,F,R,V,H,O,K,G,z,j,Q,Y;return{c(){l=i("h2"),l.textContent="Hunting",o=f(),n=i("p"),n.textContent="Let’s have a look at our recently ingested (and field-extracted) logs!",r=f(),u=i("p"),u.innerHTML="As a reminder, here are the fields and values on each log entry of our <code>access.log</code> chunk (assuming you’ve been following the instructions)",p=f(),a=i("pre"),k=f(),b=i("blockquote"),b.innerHTML="<p>Try to write a query to pull all the entries from our <code>access.log</code> chunk!</p>",_=f(),S=i("ul"),S.innerHTML=`<li>Remember, you don’t need to use all three fields above!</li> 
<li>Also keep in mind to set the <strong>time range</strong> (or use the <code>earliest</code> keyword)</li>`,y=f(),h=i("hr"),m=f(),C=i("blockquote"),C.innerHTML="<p>splunk&gt; <code>index=websftp</code></p>",B=f(),q=i("p"),q.innerHTML='<img src="images/splunk_index_websftp.png"/>',A=f(),$=i("hr"),W=f(),F=i("p"),F.innerHTML=`When looking through the logs, it isn’t very effective to just mindlessly scroll through all the events, hoping that we find some anomaly or interesting event.<br/>
We should try to be methodic in how we search!`,R=f(),V=i("p"),V.innerHTML="In our case, it would be helpful to have some directive… How about searching for the activity of a device given the IP address <code>5.134.148.228</code>?",H=f(),O=i("p"),O.innerHTML="<strong>Answer</strong>",K=f(),G=i("blockquote"),G.innerHTML="<p>splunk&gt; <code>index=websftp src_ip=5.134.148.228</code></p>",z=f(),j=i("p"),j.innerHTML="<strong>Follow-up questions</strong>",Q=f(),Y=i("ul"),Y.innerHTML=`<li>What was the device’s user agent?</li> 
<li>What did the device try to access?<ul><li>What was their HTTP response codes?</li></ul></li> 
<li>Are there any other IP addresses with the same user agent?<ul><li>What are their IP addresses, show unique addresses in a table</li></ul></li>`,X(a,"class","language-undefined")},m(d,M){t(d,l,M),t(d,o,M),t(d,n,M),t(d,r,M),t(d,u,M),t(d,p,M),t(d,a,M),a.innerHTML=w,t(d,k,M),t(d,b,M),t(d,_,M),t(d,S,M),t(d,y,M),t(d,h,M),t(d,m,M),t(d,C,M),t(d,B,M),t(d,q,M),t(d,A,M),t(d,$,M),t(d,W,M),t(d,F,M),t(d,R,M),t(d,V,M),t(d,H,M),t(d,O,M),t(d,K,M),t(d,G,M),t(d,z,M),t(d,j,M),t(d,Q,M),t(d,Y,M)},p:N,i:N,o:N,d(d){d&&e(l),d&&e(o),d&&e(n),d&&e(r),d&&e(u),d&&e(p),d&&e(a),d&&e(k),d&&e(b),d&&e(_),d&&e(S),d&&e(y),d&&e(h),d&&e(m),d&&e(C),d&&e(B),d&&e(q),d&&e(A),d&&e($),d&&e(W),d&&e(F),d&&e(R),d&&e(V),d&&e(H),d&&e(O),d&&e(K),d&&e(G),d&&e(z),d&&e(j),d&&e(Q),d&&e(Y)}}}class Zt extends ie{constructor(l){super(),oe(this,l,null,Xt,se,{})}}function Jt(s){let l,o,n,r,u,p,a,w,k,b,_,S,y,h,m,C=`<code class="language-sh"><span class="token builtin class-name">cd</span> etc/apps <span class="token comment"># Navigate to [SPLUNK]/etc/apps</span>
<span class="token function">sudo</span> <span class="token function">wget</span> https://botsdataset.s3.amazonaws.com/botsv3/botsv3_data_set.tgz <span class="token comment"># Download the dataset</span>
<span class="token function">sudo</span> <span class="token function">tar</span> zxvf botsv3_data_set.tgz <span class="token comment"># Extract the dataset</span></code>`,B,q,A,$,W,F,R,V,H,O,K,G,z,j,Q,Y,d,M,ee,Z,T,D,le,de,ae,ne,we='<code class="language-undefined">2 622676721278 eni-0536faba73134a9b7 13.125.33.130 172.16.0.178 40396 11211 17 1 50 1534778806 1534778866 ACCEPT OK</code>',fe,ue,re,x,I,ke,_e,ye,be;return F=new Ve({props:{path:"docker_splunk_botsv3.cast",options:{speed:5,cols:150}}}),{c(){l=i("h2"),l.textContent="Boss of the SOC",o=f(),n=i("p"),n.textContent="Splunk offers a CTF type challenge called ‘Boss of the SOC’. This is a sample security dataset and CTF platform for information security professionals, researchers, students, and enthusiasts.",r=f(),u=i("p"),u.textContent="The dataset has 107 source types and over 2M logs included, ranging from Windows Event Logs to AWS VPC flow logs. This would be the closest thing to what you would see in a SIEM in a commercial production environment.",p=f(),a=i("h3"),a.textContent="Setup",w=f(),k=i("p"),k.innerHTML="In another terminal (keep the current terminal that’s running Splunk open!!!), run the below command to start a <code>bash</code> shell inside of the Splunk container.",b=f(),_=i("blockquote"),_.innerHTML="<p>$&gt; <code>docker exec -it $(docker ps -qf ancestor=&quot;splunk/splunk&quot;) bash</code></p>",S=f(),y=i("p"),y.textContent="Then execute the following commands",h=f(),m=i("pre"),B=f(),q=i("p"),q.textContent="After, exit the shell and restart the container.",A=f(),$=i("blockquote"),$.innerHTML="<p>$&gt; <code>docker container restart $(docker ps -qf ancestor=&quot;splunk/splunk&quot;)</code></p>",W=f(),me(F.$$.fragment),R=f(),V=i("h3"),V.textContent="Validation",H=f(),O=i("p"),O.textContent="To verify that we have the Boss of the SOC logs ingested, we can run the below SPL query and expect some output",K=f(),G=i("blockquote"),G.innerHTML="<p>splunk&gt; <code>index=botsv3 earliest=1</code></p>",z=f(),j=i("p"),j.innerHTML='<img src="images/splunk_botsv3.png"/>',Q=f(),Y=i("hr"),d=f(),M=i("h3"),M.textContent="Parsing Fields",ee=f(),Z=i("p"),Z.innerHTML="If we scroll down and look at entries of <code>sourcetype=aws:cloudwatchlogs:vpcflow</code>.. it doesn’t seem very usable to us at the moment…",T=f(),D=i("p"),D.innerHTML='<img src="images/splunk_botsv3_vpcflow_unrecognised.png"/>',le=f(),de=i("p"),de.textContent="Based on source type we know these are AWS CloudWatch VPC flow logs.. whatever those are…",ae=f(),ne=i("pre"),fe=f(),ue=i("p"),ue.textContent="On first glance, we can see what likely appears to be 2 IP addresses and maybe ports… but without knowing the proper structure we’re only assuming.",re=f(),x=i("hr"),I=f(),ke=i("p"),ke.textContent="Before continuing on to the next page which has the answer we encourage you to do some research on AWS VPC flow logs and interpret the log entry above mapping each log part to the correct field.",_e=f(),ye=i("blockquote"),ye.innerHTML='<p>Task: Research <a href="https://lmgtfy.app/?q=What+is+an+AWS+CloudWatch+VPC+flow+log" rel="nofollow">what is an AWS CloudWatch VPC flow log</a></p>',X(m,"class","language-sh"),X(ne,"class","language-undefined")},m(v,P){t(v,l,P),t(v,o,P),t(v,n,P),t(v,r,P),t(v,u,P),t(v,p,P),t(v,a,P),t(v,w,P),t(v,k,P),t(v,b,P),t(v,_,P),t(v,S,P),t(v,y,P),t(v,h,P),t(v,m,P),m.innerHTML=C,t(v,B,P),t(v,q,P),t(v,A,P),t(v,$,P),t(v,W,P),pe(F,v,P),t(v,R,P),t(v,V,P),t(v,H,P),t(v,O,P),t(v,K,P),t(v,G,P),t(v,z,P),t(v,j,P),t(v,Q,P),t(v,Y,P),t(v,d,P),t(v,M,P),t(v,ee,P),t(v,Z,P),t(v,T,P),t(v,D,P),t(v,le,P),t(v,de,P),t(v,ae,P),t(v,ne,P),ne.innerHTML=we,t(v,fe,P),t(v,ue,P),t(v,re,P),t(v,x,P),t(v,I,P),t(v,ke,P),t(v,_e,P),t(v,ye,P),be=!0},p:N,i(v){be||(J(F.$$.fragment,v),be=!0)},o(v){g(F.$$.fragment,v),be=!1},d(v){v&&e(l),v&&e(o),v&&e(n),v&&e(r),v&&e(u),v&&e(p),v&&e(a),v&&e(w),v&&e(k),v&&e(b),v&&e(_),v&&e(S),v&&e(y),v&&e(h),v&&e(m),v&&e(B),v&&e(q),v&&e(A),v&&e($),v&&e(W),ce(F,v),v&&e(R),v&&e(V),v&&e(H),v&&e(O),v&&e(K),v&&e(G),v&&e(z),v&&e(j),v&&e(Q),v&&e(Y),v&&e(d),v&&e(M),v&&e(ee),v&&e(Z),v&&e(T),v&&e(D),v&&e(le),v&&e(de),v&&e(ae),v&&e(ne),v&&e(fe),v&&e(ue),v&&e(re),v&&e(x),v&&e(I),v&&e(ke),v&&e(_e),v&&e(ye)}}}class gt extends ie{constructor(l){super(),oe(this,l,null,Jt,se,{})}}function el(s){let l,o,n,r='<code class="language-undefined">2 622676721278 eni-0536faba73134a9b7 13.125.33.130 172.16.0.178 40396 11211 17 1 50 1534778806 1534778866 ACCEPT OK</code>',u,p,a,w,k,b,_,S,y,h,m,C,B,q,A,$,W,F,R,V,H,O,K,G,z,j,Q,Y,d,M,ee,Z,T,D,le,de,ae,ne,we,fe,ue,re,x,I,ke,_e,ye,be,v,P,ve,L;return{c(){l=i("h2"),l.textContent="AWS CloudWatch VPC Flow Logs",o=f(),n=i("pre"),u=f(),p=i("blockquote"),p.innerHTML=`<p>See <a href="https://docs.aws.amazon.com/vpc/latest/userguide/flow-logs.html" rel="nofollow">https://docs.aws.amazon.com/vpc/latest/userguide/flow-logs.html</a><br/>
Example logs: <a href="https://docs.aws.amazon.com/vpc/latest/userguide/flow-logs-records-examples.html" rel="nofollow">https://docs.aws.amazon.com/vpc/latest/userguide/flow-logs-records-examples.html</a></p>`,a=f(),w=i("p"),w.innerHTML=`We should review the example logs and check that the fields match up with our <code>botsv3</code> dataset entries.<br/>
This will require some assumptions but this is all part of the investigation.`,k=f(),b=i("hr"),_=f(),S=i("p"),S.textContent="Now that we know how the logs work lets parse them to their own fields.",y=f(),h=i("hr"),m=f(),C=i("h3"),C.textContent="Method 1 - Manual source type setup",B=f(),q=i("p"),q.innerHTML='Remember when we talked about <a href="#5">field extraction</a>? These logs looks like good candidates for a <strong>delimiter-based extraction</strong>!',A=f(),$=i("p"),$.textContent="We can run the SPL query below",W=f(),F=i("blockquote"),F.innerHTML="<p>splunk&gt; <code>index=botsv3 sourcetype=&quot;aws:cloudwatchlogs:vpcflow&quot; earliest=1</code></p>",R=f(),V=i("p"),V.innerHTML="In the field discovery column, we can then press <strong>+ Extract New Fields</strong> to start the field extraction process for <code>aws:cloudwatchlogs:vpcflow</code> source types!",H=f(),O=i("p"),O.innerHTML='<img src="images/splunk_botsv3_vpcflow_extraction.png"/>',K=f(),G=i("hr"),z=f(),j=i("h3"),j.textContent="Method 2 - Be lazy, use someone else’s work (e.g. the official AWS Splunk app)",Q=f(),Y=i("blockquote"),Y.innerHTML="<p>Splunk applications work on datasets within Splunk to either create new datasets, or to otherwise process the data in another manner.</p>",d=f(),M=i("p"),M.innerHTML="In our Splunk homepage, press <strong>+ Find More Apps</strong>",ee=f(),Z=i("p"),Z.innerHTML='<img src="images/splunk_add_app.png"/>',T=f(),D=i("p"),D.innerHTML="Then search for <code>Splunk Add-on for Amazon Web Services (AWS)</code>, and presss <strong>Install</strong>.",le=f(),de=i("p"),de.innerHTML='You will be prompted to log-in, which means <strong>it’s first time to <a href="https://www.splunk.com/en_us/sign-up.html" rel="nofollow">sign-up</a></strong>!',ae=f(),ne=i("ul"),ne.innerHTML=`<li>Use your university email address (<code>...@unsw.edu.au</code>)</li> 
<li>You will be sent a verification email that you must respond to within 30 minutes</li>`,we=f(),fe=i("p"),fe.innerHTML='<img src="images/splunk_installing.png"/>',ue=f(),re=i("hr"),x=f(),I=i("p"),I.innerHTML='The AWS Splunk addon adds the field extraction for the <code>aws:cloudwatchlogs:vpcflow</code> source type (<a href="%60aws:cloudwatchlogs:vpcflow%60">along with the other AWS source types</a>).',ke=f(),_e=i("p"),_e.textContent="With the same SPL query as before, we can now see extra fields",ye=f(),be=i("blockquote"),be.innerHTML="<p>splunk&gt; <code>index=botsv3 sourcetype=&quot;aws:cloudwatchlogs:vpcflow&quot; earliest=1</code></p>",v=f(),P=i("p"),P.innerHTML="<strong>Note: Expand the log entries and toggle the visibilty of the desired fields</strong>",ve=f(),L=i("p"),L.innerHTML='<img src="images/splunk_botsv3_vpcflow_withapp.png"/>',X(n,"class","language-undefined")},m(c,E){t(c,l,E),t(c,o,E),t(c,n,E),n.innerHTML=r,t(c,u,E),t(c,p,E),t(c,a,E),t(c,w,E),t(c,k,E),t(c,b,E),t(c,_,E),t(c,S,E),t(c,y,E),t(c,h,E),t(c,m,E),t(c,C,E),t(c,B,E),t(c,q,E),t(c,A,E),t(c,$,E),t(c,W,E),t(c,F,E),t(c,R,E),t(c,V,E),t(c,H,E),t(c,O,E),t(c,K,E),t(c,G,E),t(c,z,E),t(c,j,E),t(c,Q,E),t(c,Y,E),t(c,d,E),t(c,M,E),t(c,ee,E),t(c,Z,E),t(c,T,E),t(c,D,E),t(c,le,E),t(c,de,E),t(c,ae,E),t(c,ne,E),t(c,we,E),t(c,fe,E),t(c,ue,E),t(c,re,E),t(c,x,E),t(c,I,E),t(c,ke,E),t(c,_e,E),t(c,ye,E),t(c,be,E),t(c,v,E),t(c,P,E),t(c,ve,E),t(c,L,E)},p:N,i:N,o:N,d(c){c&&e(l),c&&e(o),c&&e(n),c&&e(u),c&&e(p),c&&e(a),c&&e(w),c&&e(k),c&&e(b),c&&e(_),c&&e(S),c&&e(y),c&&e(h),c&&e(m),c&&e(C),c&&e(B),c&&e(q),c&&e(A),c&&e($),c&&e(W),c&&e(F),c&&e(R),c&&e(V),c&&e(H),c&&e(O),c&&e(K),c&&e(G),c&&e(z),c&&e(j),c&&e(Q),c&&e(Y),c&&e(d),c&&e(M),c&&e(ee),c&&e(Z),c&&e(T),c&&e(D),c&&e(le),c&&e(de),c&&e(ae),c&&e(ne),c&&e(we),c&&e(fe),c&&e(ue),c&&e(re),c&&e(x),c&&e(I),c&&e(ke),c&&e(_e),c&&e(ye),c&&e(be),c&&e(v),c&&e(P),c&&e(ve),c&&e(L)}}}class tl extends ie{constructor(l){super(),oe(this,l,null,el,se,{})}}function ll(s){let l,o,n,r,u,p,a,w,k,b,_,S,y,h,m,C,B;return{c(){l=i("h2"),l.textContent="Timelining",o=f(),n=i("blockquote"),n.innerHTML=`<p>Looking at text is nice and all, but not very informative if we want to discover trends or patterns.<br/>
Let’s try use Splunk’s visualisation features</p>`,r=f(),u=i("p"),u.innerHTML=`We can use the <code>timechart</code> command to create a timeline that identifies events over a period of time. This could either be to detect a server with higher than normal traffic or you might be looking at destination IP address for data exfiltration.<br/>
This time we’ll look at <code>syslog</code> events`,p=f(),a=i("blockquote"),a.innerHTML="<p>splunk&gt; <code>index=botsv3 sourcetype=syslog | timechart count by sa</code></p>",w=f(),k=i("ul"),k.innerHTML=`<li><code>index=botsv3</code> - Use the <code>botsv3</code> index</li> 
<li><code>sourcetype=syslog</code> - Filter by the <code>syslog</code> source type</li> 
<li><code>|</code> - Pipe results to the next query<ul><li><code>timechart</code> - Create a timechart visualisation</li> 
<li><code>count by sa</code> - Graph the <code>count</code> by the field <code>sa</code> (source address)</li></ul></li>`,b=f(),_=i("p"),_.innerHTML="<strong>Note: <code>earliest=1</code> doesn’t work very well with visualisations</strong>",S=f(),y=i("p"),y.innerHTML='<img src="images/splunk_botsv3_timeline.png"/>',h=f(),m=i("blockquote"),m.innerHTML="<p>What’s that spike at around 9:45AM??</p>",C=f(),B=i("ul"),B.innerHTML="<li>9:45AM? Whose 9:45AM is that? America? Sydney? GMT?<ul><li>How can you confirm?</li></ul></li>"},m(q,A){t(q,l,A),t(q,o,A),t(q,n,A),t(q,r,A),t(q,u,A),t(q,p,A),t(q,a,A),t(q,w,A),t(q,k,A),t(q,b,A),t(q,_,A),t(q,S,A),t(q,y,A),t(q,h,A),t(q,m,A),t(q,C,A),t(q,B,A)},p:N,i:N,o:N,d(q){q&&e(l),q&&e(o),q&&e(n),q&&e(r),q&&e(u),q&&e(p),q&&e(a),q&&e(w),q&&e(k),q&&e(b),q&&e(_),q&&e(S),q&&e(y),q&&e(h),q&&e(m),q&&e(C),q&&e(B)}}}class sl extends ie{constructor(l){super(),oe(this,l,null,ll,se,{})}}function ol(s){let l,o,n,r,u,p,a,w,k,b,_,S,y,h,m,C,B,q,A;return{c(){l=i("h2"),l.textContent="Exercises",o=f(),n=i("h3"),n.innerHTML='Exercise 1 (<a href="#7">from Hunting</a>)',r=f(),u=i("blockquote"),u.innerHTML="<p>In the <code>websftp</code> dataset (specifically the first chunk of <code>access.log</code>)</p>",p=f(),a=i("ul"),a.innerHTML=`<li>Investigate the activity the IP address <code>5.134.148.228</code></li> 
<li>What was the device’s user agent?</li> 
<li>What did the device try to access?<ul><li>What was their HTTP response codes?</li></ul></li> 
<li>Are there any other IP addresses with the same user agent?<ul><li>What are their IP addresses, show unique addresses in a table</li></ul></li>`,w=f(),k=i("h3"),k.innerHTML='Exercise 2 (<a href="#10">from Timelining</a>)',b=f(),_=i("p"),_.innerHTML='<img src="images/splunk_botsv3_timeline.png"/>',S=f(),y=i("ul"),y.innerHTML=`<li>Explain the activity spike at around 9:45AM</li> 
<li>Confirm the locale of 9:45AM (which timezone?)</li>`,h=f(),m=i("h3"),m.textContent="Exercise 3",C=f(),B=i("blockquote"),B.innerHTML="<p>In the <code>botsv3</code> dataset</p>",q=f(),A=i("ul"),A.innerHTML=`<li>What virus (file) was found on the computer name <code>BGIST-L</code></li> 
<li>What was the virus that was found?</li> 
<li>What action was taken?</li>`},m($,W){t($,l,W),t($,o,W),t($,n,W),t($,r,W),t($,u,W),t($,p,W),t($,a,W),t($,w,W),t($,k,W),t($,b,W),t($,_,W),t($,S,W),t($,y,W),t($,h,W),t($,m,W),t($,C,W),t($,B,W),t($,q,W),t($,A,W)},p:N,i:N,o:N,d($){$&&e(l),$&&e(o),$&&e(n),$&&e(r),$&&e(u),$&&e(p),$&&e(a),$&&e(w),$&&e(k),$&&e(b),$&&e(_),$&&e(S),$&&e(y),$&&e(h),$&&e(m),$&&e(C),$&&e(B),$&&e(q),$&&e(A)}}}class il extends ie{constructor(l){super(),oe(this,l,null,ol,se,{})}}function nl(s){let l,o,n,r,u,p,a,w,k,b,_,S,y,h,m,C,B,q,A,$,W,F,R,V,H,O=`<code class="language-undefined">permission denied while trying to connect to the Docker daemon socket at unix:///var/run/docker.sock
dial unix /var/run/docker.sock: connect: permission denied</code>`,K,G,z,j,Q,Y;return{c(){l=i("h2"),l.textContent="Troubleshooting",o=f(),n=i("h3"),n.textContent="(General) Docker won’t start",r=f(),u=i("p"),u.textContent="Check that emulation is on in your BIOS settings. It might say something like “VT-d / AMD-V”",p=f(),a=i("hr"),w=f(),k=i("h3"),k.textContent="(Virtual Machine) Docker won’t start",b=f(),_=i("p"),_.textContent="Check that emulation is on in your VM settings",S=f(),y=i("hr"),h=f(),m=i("h3"),m.textContent="(Windows) Docker won’t start",C=f(),B=i("p"),B.innerHTML="Check that <code>DockerDesktopVM</code> is running in Hyper-V Manager",q=f(),A=i("hr"),$=f(),W=i("h3"),W.textContent="(Linux) Cannot interact with Docker",F=f(),R=i("p"),R.innerHTML='<em>See <a href="https://docs.docker.com/engine/install/linux-postinstall/" rel="nofollow">https://docs.docker.com/engine/install/linux-postinstall/</a></em>',V=f(),H=i("pre"),K=f(),G=i("p"),G.innerHTML="Solution: Run with <code>sudo</code>, else add your user to the Docker group",z=f(),j=i("blockquote"),j.innerHTML="<p>$&gt; <code>sudo groupadd docker; sudo usermod -aG docker $USER</code></p>",Q=f(),Y=i("p"),Y.textContent="After you have added your user to the group, re-login into your account (or just reboot)",X(H,"class","language-undefined")},m(d,M){t(d,l,M),t(d,o,M),t(d,n,M),t(d,r,M),t(d,u,M),t(d,p,M),t(d,a,M),t(d,w,M),t(d,k,M),t(d,b,M),t(d,_,M),t(d,S,M),t(d,y,M),t(d,h,M),t(d,m,M),t(d,C,M),t(d,B,M),t(d,q,M),t(d,A,M),t(d,$,M),t(d,W,M),t(d,F,M),t(d,R,M),t(d,V,M),t(d,H,M),H.innerHTML=O,t(d,K,M),t(d,G,M),t(d,z,M),t(d,j,M),t(d,Q,M),t(d,Y,M)},p:N,i:N,o:N,d(d){d&&e(l),d&&e(o),d&&e(n),d&&e(r),d&&e(u),d&&e(p),d&&e(a),d&&e(w),d&&e(k),d&&e(b),d&&e(_),d&&e(S),d&&e(y),d&&e(h),d&&e(m),d&&e(C),d&&e(B),d&&e(q),d&&e(A),d&&e($),d&&e(W),d&&e(F),d&&e(R),d&&e(V),d&&e(H),d&&e(K),d&&e(G),d&&e(z),d&&e(j),d&&e(Q),d&&e(Y)}}}class fl extends ie{constructor(l){super(),oe(this,l,null,nl,se,{})}}function ul(s){let l,o,n,r=`<code class="language-undefined">Version: 1.0 (20230612)
Maintainer: Andrew Wong (andrew.j.wong@unsw.edu.au)</code>`,u,p,a='<code class="language-undefined">Special thanks to Wesley Lacy for providing the lesson plan and resources</code>',w,k;return{c(){l=i("h1"),l.textContent="COMP6845 | Splunk",o=f(),n=i("pre"),u=f(),p=i("pre"),w=f(),k=i("p"),k.innerHTML=`In this lab we’re going to learn how to use Splunk!<br/>
We’ll start off by figuring out how to set it up, then learn how to ingest a generic log file using both regular expression and delimiter-based field extraction.<br/>
Finally, we’ll have a look at the Boss of the SOC example dataset, and use a Splunk add-on/app!`,X(n,"class","language-undefined"),X(p,"class","language-undefined")},m(b,_){t(b,l,_),t(b,o,_),t(b,n,_),n.innerHTML=r,t(b,u,_),t(b,p,_),p.innerHTML=a,t(b,w,_),t(b,k,_)},p:N,i:N,o:N,d(b){b&&e(l),b&&e(o),b&&e(n),b&&e(u),b&&e(p),b&&e(w),b&&e(k)}}}class rl extends ie{constructor(l){super(),oe(this,l,null,ul,se,{})}}function Je(s){let l,o,n=s[0][s[1]-1][0]+"",r,u,p,a;return{c(){l=i("button"),o=te("« "),r=te(n),u=te(" «")},m(w,k){t(w,l,k),U(l,o),U(l,r),U(l,u),p||(a=Ue(l,"click",s[7]),p=!0)},p(w,k){k&3&&n!==(n=w[0][w[1]-1][0]+"")&&Ge(r,n)},d(w){w&&e(l),p=!1,a()}}}function ge(s){let l,o,n=s[0][s[1]+1][0]+"",r,u,p,a;return{c(){l=i("button"),o=te("» "),r=te(n),u=te(" »")},m(w,k){t(w,l,k),U(l,o),U(l,r),U(l,u),p||(a=Ue(l,"click",s[8]),p=!0)},p(w,k){k&3&&n!==(n=w[0][w[1]+1][0]+"")&&Ge(r,n)},d(w){w&&e(l),p=!1,a()}}}function pl(s){let l,o,n,r,u,p,a=s[0][s[1]][0]+"",w,k,b,_,S,y=s[1]>0&&Je(s),h=s[1]<s[0].length-1&&ge(s);return{c(){l=i("div"),o=i("div"),n=i("div"),y&&y.c(),r=f(),u=i("div"),p=i("h4"),w=te(a),k=f(),b=i("div"),h&&h.c(),_=f(),S=i("hr"),X(n,"class","svelte-14sokvu"),X(u,"class","svelte-14sokvu"),X(b,"class","svelte-14sokvu"),X(o,"class","navigation svelte-14sokvu"),X(S,"class","svelte-14sokvu"),Pe(S,"wide",s[3]),X(l,"class","container svelte-14sokvu")},m(m,C){t(m,l,C),U(l,o),U(o,n),y&&y.m(n,null),U(o,r),U(o,u),U(u,p),U(p,w),U(o,k),U(o,b),h&&h.m(b,null),U(l,_),U(l,S),s[9](l)},p(m,[C]){m[1]>0?y?y.p(m,C):(y=Je(m),y.c(),y.m(n,null)):y&&(y.d(1),y=null),C&3&&a!==(a=m[0][m[1]][0]+"")&&Ge(w,a),m[1]<m[0].length-1?h?h.p(m,C):(h=ge(m),h.c(),h.m(b,null)):h&&(h.d(1),h=null),C&8&&Pe(S,"wide",m[3])},i:N,o:N,d(m){m&&e(l),y&&y.d(),h&&h.d(),s[9](null)}}}function cl(s,l,o){let{items:n=[]}=l,{activeItem:r}=l,u=0,p,a,w,k;it(()=>{new IntersectionObserver(([y])=>o(3,k=y.intersectionRatio<1),{threshold:[1]}).observe(w)});const b=()=>{o(1,u--,u)},_=()=>{o(1,u++,u)};function S(y){Te[y?"unshift":"push"](()=>{w=y,o(2,w)})}return s.$$set=y=>{"items"in y&&o(0,n=y.items),"activeItem"in y&&o(4,r=y.activeItem)},s.$$.update=()=>{s.$$.dirty&115&&(p!==r&&(o(5,p=r),o(1,u=n.findIndex(([y,h])=>h===r))),a!==u&&(o(6,a=u),o(4,r=n[u][1])))},[n,u,w,k,r,p,a,b,_,S]}class dl extends ie{constructor(l){super(),oe(this,l,cl,pl,se,{items:0,activeItem:4})}}const{window:ml}=at;function et(s,l,o){const n=s.slice();return n[10]=l[o][0],n[11]=l[o][1],n}function al(s){let l,o,n,r,u,p;function a(_){s[7](_)}let w={items:s[4]};s[1]!==void 0&&(w.activeItem=s[1]),l=new dl({props:w}),Te.push(()=>ht(l,"activeItem",a));var k=s[1];function b(_){return{props:{}}}return k&&(u=We(k,b()),s[8](u)),{c(){me(l.$$.fragment),n=f(),r=i("main"),u&&me(u.$$.fragment),X(r,"class","svelte-ck21ns")},m(_,S){pe(l,_,S),t(_,n,S),t(_,r,S),u&&pe(u,r,null),s[9](r),p=!0},p(_,S){const y={};!o&&S&2&&(o=!0,y.activeItem=_[1],vt(()=>o=!1)),l.$set(y);const h={};if(S&2&&k!==(k=_[1])){if(u){Ee();const m=u;g(m.$$.fragment,1,0,()=>{ce(m,1)}),De()}k?(u=We(k,b()),_[8](u),me(u.$$.fragment),J(u.$$.fragment,1),pe(u,r,null)):u=null}else k&&u.$set(h)},i(_){p||(J(l.$$.fragment,_),u&&J(u.$$.fragment,_),p=!0)},o(_){g(l.$$.fragment,_),u&&g(u.$$.fragment,_),p=!1},d(_){ce(l,_),_&&e(n),_&&e(r),s[8](null),u&&ce(u),s[9](null)}}}function wl(s){let l,o,n=s[4],r=[];for(let p=0;p<n.length;p+=1)r[p]=tt(et(s,n,p));const u=p=>g(r[p],1,1,()=>{r[p]=null});return{c(){for(let p=0;p<r.length;p+=1)r[p].c();l=ze()},m(p,a){for(let w=0;w<r.length;w+=1)r[w]&&r[w].m(p,a);t(p,l,a),o=!0},p(p,a){if(a&16){n=p[4];let w;for(w=0;w<n.length;w+=1){const k=et(p,n,w);r[w]?(r[w].p(k,a),J(r[w],1)):(r[w]=tt(k),r[w].c(),J(r[w],1),r[w].m(l.parentNode,l))}for(Ee(),w=n.length;w<r.length;w+=1)u(w);De()}},i(p){if(!o){for(let a=0;a<n.length;a+=1)J(r[a]);o=!0}},o(p){r=r.filter(Boolean);for(let a=0;a<r.length;a+=1)g(r[a]);o=!1},d(p){wt(r,p),p&&e(l)}}}function tt(s){let l,o,n;var r=s[11];function u(p){return{}}return r&&(l=We(r,u())),{c(){l&&me(l.$$.fragment),o=ze()},m(p,a){l&&pe(l,p,a),t(p,o,a),n=!0},p(p,a){if(r!==(r=p[11])){if(l){Ee();const w=l;g(w.$$.fragment,1,0,()=>{ce(w,1)}),De()}r?(l=We(r,u()),me(l.$$.fragment),J(l.$$.fragment,1),pe(l,o.parentNode,o)):l=null}},i(p){n||(l&&J(l.$$.fragment,p),n=!0)},o(p){l&&g(l.$$.fragment,p),n=!1},d(p){p&&e(o),l&&ce(l,p)}}}function bl(s){let l,o,n,r,u,p,a,w,k,b;l=new rl({});const _=[wl,al],S=[];function y(h,m){return h[0]?0:1}return u=y(s),p=S[u]=_[u](s),{c(){me(l.$$.fragment),o=f(),n=i("hr"),r=f(),p.c(),a=ze()},m(h,m){pe(l,h,m),t(h,o,m),t(h,n,m),t(h,r,m),S[u].m(h,m),t(h,a,m),w=!0,k||(b=Ue(ml,"hashchange",s[5]),k=!0)},p(h,[m]){let C=u;u=y(h),u===C?S[u].p(h,m):(Ee(),g(S[C],1,1,()=>{S[C]=null}),De(),p=S[u],p?p.p(h,m):(p=S[u]=_[u](h),p.c()),J(p,1),p.m(a.parentNode,a))},i(h){w||(J(l.$$.fragment,h),J(p),w=!0)},o(h){g(l.$$.fragment,h),g(p),w=!1},d(h){ce(l,h),h&&e(o),h&&e(n),h&&e(r),S[u].d(h),h&&e(a),k=!1,b()}}}function _l(s,l,o){let n=!1,r=[["Getting Started",Be],["License Note",$t],["Log Contexts",It],["Log Splitting",Dt],["Log Ingestion",Bt],["Field Extraction",Ft],["Introduction to Searching",Qt],["Hunting",Zt],["BotS (1)",gt],["BotS (2)",tl],["Timelining",sl],["Exercise",il],["Troubleshooting",fl]],u=Be;function p(){var y;o(0,n=location.hash=="#all"),o(1,u=((y=r[Number(location.hash.slice(1))])==null?void 0:y[1])||Be)}p();let a,w,k=!0;function b(y){u=y,o(1,u)}function _(y){Te[y?"unshift":"push"](()=>{w=y,o(3,w)})}function S(y){Te[y?"unshift":"push"](()=>{a=y,o(2,a)})}return s.$$.update=()=>{s.$$.dirty&3&&!n&&(location.hash=String(r.findIndex(([y,h])=>h===u))),s.$$.dirty&77&&w&&a&&(a.querySelectorAll("blockquote").forEach(y=>{y.textContent.startsWith("$> ")&&(y.style.userSelect="none",y.style.setProperty("--leftLineColour","#21b0d7")),y.textContent.startsWith("splunk> ")&&(y.style.userSelect="none",y.style.setProperty("--leftLineColour","#5cbf5c"))}),n||(k?o(6,k=!1):setTimeout(()=>window.scrollTo(0,a.offsetTop-50),0)))},[n,u,a,w,r,p,k,b,_,S]}class kl extends ie{constructor(l){super(),oe(this,l,_l,bl,se,{})}}new kl({target:document.getElementById("app")});
